<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Генеалогическое древо</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- D3.js for tree rendering -->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
    }

    header {
      background: #4a76a8;
      color: white;
      text-align: center;
      padding: 1rem;
    }

    #tree-container {
      width: 100%;
      height: 90vh;
      overflow: auto;
    }

    svg {
      width: 100%;
      height: 100%;
    }

    .node rect {
      fill: #ffffff;
      stroke: #4a76a8;
      stroke-width: 2px;
      rx: 10;
      ry: 10;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .node text {
      font-size: 12px;
      fill: #333;
    }

    .link {
      fill: none;
      stroke: #999;
      stroke-opacity: 0.6;
      stroke-width: 2px;
    }

    .tooltip {
      position: absolute;
      background: white;
      border: 1px solid #ddd;
      padding: 8px;
      font-size: 13px;
      border-radius: 5px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
    }
  </style>
</head>
<body>
  <header>
    <h1>Генеалогическое древо семьи</h1>
  </header>

  <div id="tree-container"></div>
  <div id="tooltip" class="tooltip"></div>

  <script>
    // Example genealogical data
    const data = {
      name: "Иванов Иван Петрович",
      years: "1920–1980",
      profession: "Учитель",
      residence: "Москва",
      children: [
        {
          name: "Иванова Анна Ивановна",
          years: "1945–2005",
          profession: "Врач",
          residence: "Санкт-Петербург"
        },
        {
          name: "Иванов Сергей Иванович",
          years: "1950–2010",
          profession: "Инженер",
          residence: "Новосибирск",
          children: [
            {
              name: "Иванова Мария Сергеевна",
              years: "1975–",
              profession: "Программист",
              residence: "Екатеринбург"
            },
            {
              name: "Иванов Алексей Сергеевич",
              years: "1980–",
              profession: "Предприниматель",
              residence: "Москва"
            }
          ]
        }
      ]
    };

    // Tooltip reference
    const tooltip = d3.select("#tooltip");

    // Setup SVG and group
    const width = document.getElementById("tree-container").clientWidth;
    const height = document.getElementById("tree-container").clientHeight;

    const svg = d3.select("#tree-container")
      .append("svg")
      .attr("width", width)
      .attr("height", height)
      .append("g")
      .attr("transform", "translate(40,40)");

    // Create tree layout
    const root = d3.hierarchy(data);
    const treeLayout = d3.tree().size([height - 100, width - 200]);
    treeLayout(root);

    // Draw links
    svg.selectAll(".link")
      .data(root.links())
      .enter()
      .append("path")
      .attr("class", "link")
      .attr("d", d3.linkHorizontal()
        .x(d => d.y)
        .y(d => d.x)
      );

    // Draw nodes
    const node = svg.selectAll(".node")
      .data(root.descendants())
      .enter()
      .append("g")
      .attr("class", "node")
      .attr("transform", d => `translate(${d.y},${d.x})`);

    // Node rectangles
    node.append("rect")
      .attr("width", 160)
      .attr("height", 60)
      .attr("x", -80)
      .attr("y", -30)
      .on("mouseover", function(event, d) {
        tooltip.style("opacity", 1)
          .html(`
            <b>${d.data.name}</b><br>
            Годы жизни: ${d.data.years}<br>
            Род деятельности: ${d.data.profession}<br>
            Где жил: ${d.data.residence}
          `)
          .style("left", (event.pageX + 15) + "px")
          .style("top", (event.pageY - 20) + "px");
      })
      .on("mousemove", function(event) {
        tooltip.style("left", (event.pageX + 15) + "px")
               .style("top", (event.pageY - 20) + "px");
      })
      .on("mouseout", function() {
        tooltip.style("opacity", 0);
      });

    // Node labels
    node.append("text")
      .attr("dy", "-5")
      .attr("text-anchor", "middle")
      .text(d => d.data.name);

    node.append("text")
      .attr("dy", "12")
      .attr("text-anchor", "middle")
      .attr("font-size", "11px")
      .attr("fill", "#666")
      .text(d => d.data.years);
  </script>
</body>
</html>
